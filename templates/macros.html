{% extends "base.html" %}

{% block title %}Calculadoras Nutricionales{% endblock %}

{% block content %}
    <div class="container my-5">
        <h1 class="text-center text-success mb-5">Calculadoras Nutricionales</h1>
        <div class="card mb-4 border-success">
            <div class="card-header bg-success text-white">
                <h2 class="h5 mb-0">Distribución de Macronutrientes (Macros)</h2>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="caloriasMacros" class="form-label text-success">Total de Calorías Diarias (kcal):</label>
                    <input type="number" id="caloriasMacros" class="form-control" placeholder="Ej: 2000" required>
                </div>
                <div class="mb-3">
                    <label for="distribucionMacros" class="form-label text-success">Distribución (P/C/G):</label>
                    <select id="distribucionMacros" class="form-select">
                        <option value="30/40/30">Estándar (30% Prot / 40% Carb / 30% Gras)</option>
                        <option value="40/30/30">Alta en Proteína (40% Prot / 30% Carb / 30% Gras)</option>
                        <option value="20/50/30">Alto Carbohidrato (20% Prot / 50% Carb / 30% Gras)</option>
                    </select>
                </div>
                <button onclick="calcularMacros()" class="btn btn-success w-100">Calcular Macros</button>
                <div class="mt-3 p-3 bg-light rounded border border-success">
                    <p class="mb-0 text-success">Resultado Gramos:</p>
                    <strong id="resultadoMacros" class="h6"></strong>
                </div>
            </div>
        </div>
{% endblock %}

{% block scripts %}
    <script>
        function obtenerValor(id) {
            const valor = parseFloat(document.getElementById(id).value);
            if (isNaN(valor)) {
                return null;
            }
            return valor;
        }

        function calcularMacros() {
            const totalCalorias = obtenerValor('caloriasMacros');
            const distribucionStr = document.getElementById('distribucionMacros').value;
            
            if (!totalCalorias) {
                document.getElementById('resultadoMacros').innerHTML = "Error: Ingrese las calorías totales.";
                return;
            }

            const [p, c, g] = distribucionStr.split('/').map(val => parseFloat(val) / 100);

            const protGramos = Math.round((totalCalorias * p) / 4);
            const carbGramos = Math.round((totalCalorias * c) / 4);
            const grasaGramos = Math.round((totalCalorias * g) / 9);

            document.getElementById('resultadoMacros').innerHTML = `
                <p class="mb-1">Proteínas: <strong>${protGramos} g</strong> (${(p*100).toFixed(0)}%)</p>
                <p class="mb-1">Carbohidratos: <strong>${carbGramos} g</strong> (${(c*100).toFixed(0)}%)</p>
                <p class="mb-1">Grasas: <strong>${grasaGramos} g</strong> (${(g*100).toFixed(0)}%)</p>
            `;
        }
    </script>
    {% endblock %}